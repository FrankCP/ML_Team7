<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>homework2.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>homework2</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/index-CXWNxYPw.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/preload-helper-WDmkW-6F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useEventListener-BMXqdHZ5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/jsx-runtime-B4_2-8Ho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Combination-DIF6wDxT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clsx-CGw3WJH5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cn-f3ruLt4G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/menu-items-QU91GQzu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/hotkeys-sK-kaEBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/button-BtVgadIf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-DTKIwXcy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/createLucideIcon-C9QGcv--.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/check-Pczj-rmu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/select-Dre1F6mo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/multi-map-Z_hg0zTh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chevron-right-Cn1LhTdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dropdown-menu-DL4QHRL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tooltip-DEUNsdbK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/invariant-EWlZS5z8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/merge-DVX6Ez37.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/utils-Clm_pCuX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/requests-CMMs4cl8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/once-DF3Ybce_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toDate-J43JkZRd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseSlice-CskhCEVH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_hasUnicode-BC4vb_bF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useLifecycle-bYJVBwo9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/capitalize-HqFs_OK0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ai-model-dropdown-BiaBgfSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/badge-DjEl44tW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/use-toast-CTk3v2Fk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/constants-O0mPFSN0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Deferred-cELqHKYi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/config-ljv4_QXT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/uuid-DFgsIVBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/DeferredRequestRegistry-DUZWfqOX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/connection-DZfQ0nfK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useNonce-BPtPhVM4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/capabilities-DPEuN0Kv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/createReducer-uDMmKGBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-hQAzR0Cy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-a5AhnPua.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BWV-5FQQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BRKC9vDH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-C2lGLtUJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-DjRxw7g7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BFZNB01C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CiIxDFsH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-AYL4p4Dn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/stex-BQjjdb1n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cjs-VdEqhsWH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_arrayReduce-BPS6ICyD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/type-Bx7IFbhF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseProperty-Bl8lQyHQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/now-DBnXnRPe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/debounce-BzCP2SOK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/main-B1nOh376.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cells-XWXpgwpH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/kbd-BGS9frER.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/renderShortcut-CF5R2n1d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useEvent-bc5jSpSz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDeleteCell-D5AVSLUE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/lazy-ShQ0UXOI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/defaultLocale-9ao8Dcla.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/precisionRound-BdwMj645.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/defaultLocale-Bu1vZnwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vega-loader.browser-DUgPL0IU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tooltip-tPIJZni7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ErrorBoundary-Xx3vyups.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/alert-dialog-CYJZg0vV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dialog-C-S4uQH4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDebounce-Dz48GAub.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/numbers-BWXaNlZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/SSRProvider-DrIPqn2D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/context-C5uPODSj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useNumberFormatter-C1aNc7b4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/usePress-CuSksPzr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/input-fjIzfaON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ImperativeModal-DD50EU1G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cell-link-D4ddCDwe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/alert-BP5lLEUu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/links-9tVC0887.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/state-BUWnJ0Ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/MarimoErrorOutput-CBrjDxLd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-CL0ql7QN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-CGmj_xHa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-icon-DyWZDAiU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/spinner-cyqSIlb0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CSuUnJvL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/focus-BLLpcsff.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/popover-CmnWYkoH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useRunCells-Ds9oEET1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mode-OgOLIWqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/purify.es-B1k9qoU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/RenderHTML-CDZ5aEc_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/table-NPSY8_Zm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tabs-CWZFOtfb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/add-missing-import-CtAvQzRq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useAsyncData-CWTnKpYp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useIframeCapabilities-DeznJSW5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/LazyAnyLanguageCodeMirror-LOVWlBJF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/error-banner-BVpxvuDQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/formats-C_m3CfBz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useTheme-DNzypnwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/en-US-DZkKelDe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isValid-CB2nX3F0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/maps-CcaFd04c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/shim-DZsTM49a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/download-Yhx6Ym5-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/extends-r-9mmG40.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/emotion-is-prop-valid.esm-CvS1dbIX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDateFormatter-BQepJAoC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/katex-BWHK7JiN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/marked.esm-D2gFq9fv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chunk-T7OEMACY-DmsJ7oRM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/range-CWPLRnRw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/table-BqDahwx2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Output-DaxqEvBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/name-cell-input-Czy9kSf0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useHotkey-fEzjOJm_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-C90uzGgn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CXTCcHAx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-yuFtFIvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-FxKIA4Su.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BTwRVGbc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Dk-ec10U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Bt-XL6sZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CO0hHVso.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-B_1rC47Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Cav6n7Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BilWanrC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Bs4awW3v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-ByISUkN_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/apl-P0h8Mr-1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/asciiarmor-D32nrZfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/asn1-BGWFqtof.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/brainfuck-bRbTK_ul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clike-CDpf5LdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clojure-BIaW7E1P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cmake-Fdo8v8A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cobol-OYTcoAp0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/coffeescript-DnHAeBoz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/commonlisp-DZODvuDN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/crystal-ByGYU1ry.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/css-DQy1ktIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cypher-BqzuHhct.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/d-5Fj8y8Ro.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/diff-K3UuOlLk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dtd-COG0IeNI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dylan-Dfhc0Kak.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ecl-BMslxTqn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/eiffel-DoFPZKgO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/elm-CWDHfGfn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/erlang-C0xdvudI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/simple-mode-Ccflbu9h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/factor-DEtwqCL8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/forth-A93hDrjr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/fortran-CuTjeCKb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gas-CiyaCjl_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gherkin-BcwByeby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/groovy-r2-fZFco.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/haskell-7o_rdGTQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/haxe-DYRKW28o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/idl-lxzFEdlJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/javascript-BVerENn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/julia-BKrwhn35.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/livescript-DXZTF8eQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/lua-1kf1Kn_-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mathematica-DbM7qeVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mbox-yeyE7jAy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mirc-BUIfkQcx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mllike-cuHPGaql.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/modelica-DVVkMuX_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mscgen-4Argcv2M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mumps-BnAFQnrr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/nsis-BapZHEue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ntriples-KcW691KM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/octave-aZeHY9oT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/oz-Cp3up0rm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pascal-eBaSS2b_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/perl-DEhUvkqp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pig-Bbx0-A3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/powershell-C-a2xSWe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/properties-D4oZTSRw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/protobuf-vt_-BoIh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pug-CuQCjsS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/puppet-v_FxnHdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/python-Ciz3nOoG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/q-BAMmJTXP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/r-BThezCV8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/rpm-DqZBhvGf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ruby-COOWtg59.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sas-D7AOhztC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/scheme-CBocbbdR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/shell-lT1vcZaF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sieve-Bp4wNuXd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/smalltalk-C8zenhWl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sparql-Bfstq9Rh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/stylus-C2Em32WT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/swift-CQbdtQmS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tcl-CgwjN-Du.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/textile-CPuJdR_5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toml-DLqKhfOq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/troff-BaD0cBMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ttcn-cfg-C9NOBlCe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ttcn-DOB8C7GW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/turtle-_7wd09RB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vb-E90VhI05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vbscript-CtQr8UoL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/velocity-B4-NqC87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/verilog-CCpiILSH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vhdl-CrGqTZyE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/webidl-Ct6MbsZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/xquery-DNK7TlxO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/yacas-BK5XHzX2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/z80-DT8q_Ryr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/esm-hcUBDEjZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/objectWithoutPropertiesLoose-dfl_7i8r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/esm-DDxkZACy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/trash-DI_RMnlv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ConsoleOutput-1UUGbXpT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/icons-CVbUY4lM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/blob-CIREuKO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/add-cell-with-ai-CSoCSUxd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chart-no-axes-column-Bji-_7ip.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/square-function-DNygr9WL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/spec-BZnptJuy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useInstallPackage-DCDc7NTf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/column-preview-DN61SPFU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useAddCell-BrByzpGu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toggle-DAkPAKX9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/api-2JaIsahG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/globals-eSrTJiES.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/share-BCjx5a8M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CSLSra8C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_toKey-C5ccFCJm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseSet-BwKym8Ma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/utilities.esm-CFYsyNzv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/floating-outline-Bk6kjZw5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/eye-off-CkynlJbW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/plus-CcDW_rEW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/readonly-python-code-mq6FZbVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-video-camera-DxwR0TAX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-text-DYJz3QFG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-DdZ6Vgf6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/types-CKActxHf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/label-CzgZucd0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/textarea-d-UPtQ6q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/circle-x-72ItD0Ur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/refresh-ccw-BHxANXt5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/trash-2-DkyoQBeV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/form-DhU-C-zB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/field-fjEDxnj7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/switch-BskylHTJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useBoolean-BKHo47jI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDeepCompareMemoize-CMu624yo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/types-DBTQaHSP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/prop-types-8ppFGRBY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/es-BMRi-PYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/VisuallyHidden-B6MGE2am.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseFlatten-CnCoQev7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/get-DaaGyK0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/hasIn-Ddg4IE2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_basePickBy-CPlg9rol.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pick-DON_s7R5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/send-BBhGiLCG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/code-xml-fIuLXB6s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/download-CRVp7nwp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/globe-B7EKeryr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/refresh-cw-DHav_aX8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/settings-DCyJEp5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/square-2ncKmcyv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/triangle-alert-CITCjWDo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-x0pnLWWY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/bundle.esm-CBRGmh5t.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/index-7bO8TuDm.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "homework2.py",
            "mode": "read",
            "version": "0.18.3",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n# Importing The Required Libraries\n\"\"\")", "code_hash": "81a581141199195f22a89a651aff3b91", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os \nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report", "code_hash": "913ee29ba96c561bdfa180c0be962b31", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Our Functions\n\"\"\")", "code_hash": "e371f82b93e743f72b8bf2f0d595065c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "def CorrectDate(df):\n    for col in df.columns:\n        if 'date' in col:\n            df[col] = pd.to_datetime(df[col])", "code_hash": "75129dfd8233791d453283e995e83c3f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "def Split_and_scale(X, y, test_size=0.2, scaled=True):\n    _X_train, _X_test, _y_train, _y_test = train_test_split(X, y, test_size=0.2, random_state=42)  # Splitting the data into training and testing sets\n    if scaled == True:\n        scaler = StandardScaler()\n        _X_train_scaled = scaler.fit_transform(_X_train)  # Returning scaled or unscaled data based on the Scaled parameter\n        _X_test_scaled = scaler.transform(_X_test)\n        return (_X_train_scaled, _X_test_scaled, _y_train, _y_test)\n    else:\n        return (_X_train, _X_test, _y_train, _y_test)", "code_hash": "ab19a764c48cd0a2784d2dc9625f7d25", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "def Evaluate_model(y_test, y_pred):\n    print('Accuracy:', accuracy_score(_y_test, _y_pred))\n    print(confusion_matrix(_y_test, _y_pred))\n    print(classification_report(_y_test, _y_pred))", "code_hash": "58a6c73208284c486034129a59dd341f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Getting Our Data\n\"\"\")", "code_hash": "ae9f7dac98fac69a9c1a6edcd5f789b8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Visual Looking To Our Datasets\n\"\"\")", "code_hash": "3fc1e655053bf17d34c8f0c099e98ada", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "df_calendar = pd.read_csv('../calendar.csv')\ndf_calendar", "code_hash": "43a6bce4eb237e048cb1030ac2b9f9c6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "df_city = pd.read_csv('../city.csv')\ndf_city", "code_hash": "c31453c41a95a2b0216887320d54e205", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "df_passenger= pd.read_csv('passenger.csv')\ndf_passenger", "code_hash": "47229d0153b394f1092a475009d4a41d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "df_trip = pd.read_csv('trip.csv')\ndf_trip", "code_hash": "c0b01694f1185bb29a942c0fc8e18216", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Data Preparation: Cleaning \u0026 Preprocessing\n\"\"\")", "code_hash": "2d997aacd734523bf8fdd9c059ec5d82", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "# Rename columns to add prefixes\ndf_city.columns  = 'city_' + df_city.columns \ndf_passenger.columns  = 'passenger_' + df_passenger.columns\ndf_calendar.columns  = 'calendar_' + df_calendar.columns\n\n# This will rename a specific column back to its original name\ndf_calendar.rename(columns={'calendar_calendar_date': 'calendar_date'}, inplace=True)", "code_hash": "c4c3fd82171c73470b01ceb0950f63a8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "# Adding the city names and first_call_time to our trips dataframe\n# by merging on df_trip, df_city, and df_passenger\ndf = df_trip.merge(df_city, on='city_id', how='left')\ndf = df.merge(df_passenger, on='passenger_id', how='left')\n\n# Let's see the shape of the dataframe after merging\nprint(df.info(), '\\n-------------\\n')\ndf.head()", "code_hash": "1741f0f6eac0d00faafc0fda28a0a63c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"\n\u003E As we see, the time columns are strings instead of datetime\n\"\"\")", "code_hash": "080e13d3bf59e0c1509496b39807b283", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "# Let's correct time and date columns\ndf['call_time'] = pd.to_datetime(df['call_time'], format=\"%m/%d/%Y %I:%M:%S %p\")\ndf['finish_time'] = pd.to_datetime(df['finish_time'], format=\"%m/%d/%Y %I:%M:%S %p\")\ndf['passenger_first_call_time'] = pd.to_datetime(df['passenger_first_call_time'], format=\"%m/%d/%Y %I:%M:%S %p\")\ndf['Trip_duration'] = (df['finish_time'] - df['call_time']).dt.total_seconds() / 60\ndf_calendar['calendar_date'] = pd.to_datetime(df_calendar['calendar_date'], format=\"%m/%d/%Y\")", "code_hash": "6296bdb5e00c95e25d6def5837dca9d1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "# Extract date from datetime columns\ndf['passenger_first_call_date'] = df['passenger_first_call_time'].dt.date\ndf['call_date'] = df['call_time'].dt.date\n\n# The new columns will be of object type, so we convert them to datetime\nCorrectDate(df)\n\n# Let's see the final structure of our dataframe\nprint(df.columns)\nprint('\\n-------------------\\n')\nprint(df.info())", "code_hash": "2b36d1fbd65d8d53e77bfc5a325ac07a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "# The current dataframe 'df' contains trip-level data.\n# We will now aggregate this data to create a user-level dataframe 'df_users'.\ndf_users = pd.pivot_table(\n    df,\n    index=['passenger_id'],\n    aggfunc={\n        'id': 'nunique',\n        'city_id': 'first',\n        'city_name': 'nunique',\n        'driver_id': 'nunique',                  \n        'surge_rate': 'mean',                    \n        'trip_distance': ['sum', 'mean'],        \n        'trip_fare': ['sum', 'mean'],            \n        'passenger_first_call_date': 'first',    \n        'call_date': 'last'                \n    }\n)\n\nprint('Old Columns', df_users.columns)\n\n# Flattening and renaming multiIndex columns\ndf_users.columns = [\n    'last_trip_date',\n    'first_city',             \n    'distinct_cities',          \n    'distinct_drivers',     \n    'total_trips',                \n    'first_trip_date',            \n    'avg_surge',               \n    'avg_trip_distance',          \n    'total_trip_distance',        \n    'avg_trip_fare',            \n    'total_trip_fare'      \n]\n\n# Changing date columns to datetime format\nCorrectDate(df_users)\n\n# Let's reset the index to have passenger_id as a column\ndf_users.reset_index(inplace=True)\n\n# Final structure of user-level dataframe\ndf_users.info()", "code_hash": "0d9ca13c9c877a426582e4af74dbfce5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "# According to the problem definition, a customer is considered churned if they haven\u2019t \n# used the application for more than 28 days.\n# Let's get the churn threshold date\nall_dates = df[['call_date']].sort_values(by='call_date')['call_date'].unique()\nmax_date = all_dates[-1]\nsteps_back = churn_threshold_slider.value + 1\nchurn_cutoff = all_dates[-steps_back]\nmau_index = df_users[df_users['last_trip_date'] \u003C churn_cutoff].index\ndf_users['Churn'] = 0\ndf_users.loc[mau_index, 'Churn'] = 1\nchurn_rate = df_users['Churn'].mean()", "code_hash": "ca8b97e8314930a4e448bd52cb2ebb14", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "# The only columns I want from calendar are calendar_date and calendar_holiday\ndf_calendar_1 = df_calendar[['calendar_date', 'calendar_holiday']]\ndf_users_1 = df_users.merge(df_calendar_1, left_on=df_users['first_trip_date'], right_on=df_calendar_1['calendar_date'], how='left')\n# Merge to df_users and df_calendar to get which customers joined to us on a holiday\ndf_users_1['Joined On Holiday'] = df_users_1['calendar_holiday']\ndf_users_1['Churn'] = df_users['Churn'] \ndf_users_1.drop(columns=['calendar_date', 'calendar_holiday', 'key_0'], inplace=True)\n# Droping unnecessary columns \ndf_users_1.dropna(inplace=True)\n# We have some NaN values in avg_surge and trip_distance columns\n# They are a few, so let's drop them\n# Final structure of user-level dataframe\ndf_users_1.info()", "code_hash": "1d4806dd1ca99cd4b3182f7a649cb7d8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "mo.md(r\"\"\"\n# ML Model Part\n\"\"\")", "code_hash": "e05fba688f33cf0213cd439191da21ee", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ulZA", "name": "_"}, {"code": "mo.md(r\"\"\"\n### Feature Engineering Part\n\"\"\")", "code_hash": "316a2a5bcb80319b1a07c6b2fea91817", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "# Creating our new features\ndf_users_1['Customer_Lifetime_Days'] = (churn_cutoff - df_users_1['first_trip_date']).dt.days\ndf_users_1[\"trips_per_week\"] = df_users_1[\"total_trips\"] / ((df_users_1[\"Customer_Lifetime_Days\"] / 7) + 1)\ndf_users_1['days_since_last_trip'] = df_users_1['Customer_Lifetime_Days'] - df_users_1['last_trip_date'].dt.dayofyear\ndf_users_1['trips_per_day'] = df_users_1['total_trips'] / (df_users_1['Customer_Lifetime_Days'] + 1)\ndf_users_1['fare_per_km'] = df_users_1['total_trip_fare'] / (df_users_1['total_trip_distance'] + 1)\ndf_users_1['fare_per_trip'] = df_users_1['total_trip_fare'] / (df_users_1['total_trips'] + 1)\ndf_users_1['surge_volatility'] = df_users_1['avg_surge'] * df_users_1['distinct_cities']\ndf_users_1['long_trip_ratio'] = df_users_1['total_trip_distance'] / (df_users_1['avg_trip_distance'] + 1)\ndf_users_1['lifetime_trip_rate'] = df_users_1['total_trips'] / (df_users_1['Customer_Lifetime_Days'] + 1)\ndf_users_2 = df_users_1.replace([np.inf, -np.inf], np.nan)\n# Corecting inf due to dividion by zero\n# We have some NaN values after creating new features\ndf_users_2.dropna(inplace=True)\ndf_users_1", "code_hash": "d8784e5e4d547b56d5bced1407e131c2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "new_features = ['days_since_last_trip', 'trips_per_day', 'trips_per_week', 'fare_per_km', 'fare_per_trip', 'surge_volatility', 'long_trip_ratio', 'lifetime_trip_rate', 'Churn']\nplt.figure(figsize=(12, 10))\nsns.heatmap(df_users_2[new_features].corr(), annot=False)\nplt.title('Correlation Heatmap')\nplt.show()", "code_hash": "c1e7287e188a76a5f9bf4bead73b6eca", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "mo.md(r\"\"\"\n### Clustering Part\n\"\"\")", "code_hash": "4d46dd235ffdd34ac6196e76d776f66f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aLJB", "name": "_"}, {"code": "# Our Chosed features\nCluster_f = ['Customer_Lifetime_Days', 'trips_per_week', 'lifetime_trip_rate', 'fare_per_trip', 'total_trip_fare', 'long_trip_ratio', 'distinct_cities']\ncluster_features = df_users_2[Cluster_f].copy()\nscaler = StandardScaler()\n# Getting a copy of our data with the most important features\n# Scale features\nX_scaled = scaler.fit_transform(cluster_features)", "code_hash": "052e3eb9fa7fbea71be1f84fee72e3e5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"\n\u003E Let's get the best number of clusters for our data\n\"\"\")", "code_hash": "e5f7ce3e60ebe03ecd6580e0be3777d1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "inertias = []\nK = range(2, 8)\n\nfor k in K:\n    km = KMeans(n_clusters=k, random_state=42, n_init=10)\n    km.fit(X_scaled)\n    inertias.append(km.inertia_)\n\nplt.figure(figsize=(7, 4))\nplt.plot(K, inertias, marker='o')\nplt.xlabel(\"Number of clusters (k)\")\nplt.ylabel(\"Inertia\")\nplt.title(\"Elbow Method for Optimal k\")\nplt.grid(True)\nplt.show()", "code_hash": "7bc7ec2e10da402a5c7336752a3b5018", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "best_k = n_clusters_slider.value\nkmeans_final = KMeans(n_clusters=best_k, random_state=42, n_init=10)\n_cluster_labels = kmeans_final.fit_predict(X_scaled)\ndf_users_2['cluster_behavior'] = _cluster_labels", "code_hash": "8942258020e41987cafba7febdd837a1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "# Let's get the centers and figure out the charaterics of our clusters\ncenters = pd.DataFrame(\n    scaler.inverse_transform(kmeans_final.cluster_centers_),\n    columns=cluster_features.columns\n)\n\ncenters", "code_hash": "be0503e208c46b58ecca120b160ef826", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "NCOB", "name": "_"}, {"code": "# Renaming our clusters\ndf_users_2['cluster_behavior'].replace({0: 'Casual Customer', 1: 'High-usage customers', 2: 'Moderate-usage customers'}, inplace=True)\n# Showing different clusters of our current users\ndf_users_2[df_users_2['Churn'] == 0]['cluster_behavior'].value_counts()", "code_hash": "b33fc50eaae9b2549e8975bfb4d3480e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"\n\u003E The analysis shows that the segments worth focusing on are the moderate-usage customers with an average lifetime near to 306 days, and the high-usage customers near to 282 days. The other clusters represent casual users whose churn is less critical.\n\"\"\")", "code_hash": "36a9ce56e6e455a5fe31002a8af2e214", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "mo.md(r\"\"\"\n# The Visualization Part\n\"\"\")", "code_hash": "19d269fd4e14f1a84be04fe971f5e785", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dNNg", "name": "_"}, {"code": "churn_threshold_slider = mo.ui.slider(\n    start=28, stop=180, value=28,\n    label=\"Churn inactivity threshold (days)\"\n)\n\nn_clusters_slider = mo.ui.slider(start=3, stop=12, step=1, label=\"Number of clusters\")\n\n\ntrips_week_slider = mo.ui.slider(\n    start=1, stop=10, value=1,\n    label=\"Trips per week\"\n)", "code_hash": "061f178164b1eb63754626691ccdf1e3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "date_from = mo.ui.date(\n    label=\"From\",\n    value=str(df_users_2['last_trip_date'].min().date())\n)\n\napply_button = mo.ui.button(\"Apply Date Range\")\n\ndate_to = mo.ui.date(\n    label=\"To\",\n    value=str(df_users_2['last_trip_date'].max().date())\n)\n\napply_button = mo.ui.button(\"Apply Date Range\")", "code_hash": "704a940694d468938ce20770a588a7b7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wlCL", "name": "_"}, {"code": "mo.vstack([\n    churn_threshold_slider,\n    n_clusters_slider,\n    trips_week_slider,\n    mo.hstack([date_from, date_to, apply_button])\n])", "code_hash": "83e264c234a0318cf79b5bda083326b5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "df_users_3 = df_users_2[df_users_2['last_trip_date'].between(str(date_from.value),str(date_to.value))]", "code_hash": "2f6a2b3f287044a9c28208b320ab3e25", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wAgl", "name": "_"}, {"code": "churned = df_users_3[\"Churn\"].sum()\nchurn_rate_ = df_users_3[\"Churn\"].mean()\n\n\nlast_date_ = df_users_3.sort_values('last_trip_date', ascending = False)['last_trip_date'].unique()[:churn_threshold_slider.value][-1]\nactive_users = df_users_3[df_users_3['last_trip_date']\u003E last_date_][\"passenger_id\"].nunique()\n\n\ncard1 = mo.md(\n        f\"\"\"\n        ### Churn cutoff date  \n        **{churn_cutoff}**\n        \"\"\"\n    )\n\ncard2 = mo.md(\n        f\"\"\"\n        ### Churned users  \n        **{churned:,}**\n        \"\"\"\n    )\n\ncard3 = mo.md(\n        f\"\"\"\n        ### Churn rate  \n        **{churn_rate_:.2%}**\n        \"\"\"\n    )\n\ncard4 = mo.md(\n        f\"\"\"\n        ### Active Users  \n        **{active_users:,}**\n        \"\"\"\n    )\n\n# Display them beside each other (like Power BI)\nmo.hstack([card1, card2, card3, card4], widths=\"equal\", gap=2)", "code_hash": "aefbd12c9ce0c25516322711efe8f740", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "# Getting feature columns from the cluster centers.\n_features = list(centers.columns)\ndata = centers.values\n# Getting the centers values\ndata_min = data.min(axis=0)\ndata_max = data.max(axis=0)\n# Normalize Data\n# We scale all feature values to the range 0.1\u20131.0 so the radar\nnorm_data = (data - data_min) / (data_max - data_min + 1e-09)\nnorm_data = 0.1 + 0.9 * norm_data\nplot_data = np.concatenate([norm_data, norm_data[:, [0]]], axis=1)\nnum_vars = data.shape[1]\nangles = np.linspace(0, 2 * np.pi, num_vars, endpoint=False)\n# Prepare Data for Radar Chart\nangles = np.concatenate([angles, [angles[0]]])\n_cluster_labels = [f\"Cluster {i}\" for i in range(centers.shape[0])]\n# Create Angles for Each Feature\n#  Angles are evenly spaced around the circle.\nplt.figure(figsize=(8, 8))\nax = plt.subplot(111, polar=True)\nfor i, label in enumerate(_cluster_labels):  # close the loop\n    ax.plot(angles, plot_data[i], linewidth=2, marker='o', label=label)\n# Plot Radar Chart\n    ax.fill(angles, plot_data[i], alpha=0.15)\nax.set_xticks(angles[:-1])\nax.set_xticklabels(_features)\nax.set_ylim(0, 1)\nplt.title('Customer Loyalty Cluster Profile (Radar Chart)')\nplt.legend(loc='upper right', bbox_to_anchor=(1.3, 1.1))\nplt.tight_layout()\n# Format Axes and Labels\nplt.show()", "code_hash": "dad2a7c37b65a466fd57ec09520e9254", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dGlV", "name": "_"}, {"code": "def plot_feature_bar_matplotlib(df = df_users_3, feature = 'cluster_behavior' ):\n    df_grouped = df.groupby(\"cluster_behavior\")[feature].sum()\n    fig, ax = plt.subplots(figsize=(6, 4))\n    ax.bar(df_grouped.index, df_grouped[feature])\n    ax.set_title(f\"Bar Chart for {feature}\")\n    ax.set_xlabel(\"Index\")\n    ax.set_ylabel(feature)\n    plt.tight_layout()\n\n    return fig", "code_hash": "cc451f25abd6dd52f07a6000b8851f1e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SdmI", "name": "_"}, {"code": "cols = df_users_2.columns.tolist()\n\nfeature_select1 = mo.ui.dropdown(\n    options=cols,\n    label=\"Choose a feature for the barplot\",\n    value=cols[0]\n)\n\n\nfeature_select2 = mo.ui.dropdown(\n    options=cols,\n    label=\"Choose x feature to the barplot\",\n    value=cols[0]\n)\nmo.hstack([feature_select1, feature_select2])", "code_hash": "1fadd0e86492e0afcc34bbc39f4e4792", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lgWD", "name": "_"}, {"code": "def countplot_seaborn(df, feature):\n    import matplotlib.pyplot as plt\n    import seaborn as sns\n\n    plt.figure(figsize=(6, 4))\n\n    # Orange countplot\n    sns.countplot(\n        data=df,\n        x=feature,\n        color=\"#FF8C00\"\n    )\n\n    plt.title(f\"Countplot of {feature}\")\n    plt.xlabel(feature)\n    plt.ylabel(\"Number Of Users\")\n    plt.xticks(rotation=45)\n    plt.tight_layout()\n\n    fig = plt.gcf()\n    return fig\n\n\n\ncountplot_seaborn(df_users_3, \"cluster_behavior\")", "code_hash": "7967f575a1ca9fc5b5d1c63fa1eca5fb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "df_users_3.select_dtypes(\"object\").columns", "code_hash": "05e90bb1d003f155e29af82519de7e0d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fwwy", "name": "_"}, {"code": "df_users_3", "code_hash": "5b7fc77280f110365887a4e3ecacb8a2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LJZf", "name": "_"}, {"code": "def build_pivot_table(df, index_col, value_col, aggfunc_name):\n    import pandas as pd\n\n    # Map readable names to real pandas aggfuncs\n    agg_map = {\n        \"Mean\": \"mean\",\n        \"Sum\": \"sum\",\n        \"Count\": \"count\",\n        \"Std\": \"std\",\n        \"Min\": \"min\",\n        \"Max\": \"max\",\n    }\n\n    aggfunc = agg_map[aggfunc_name]\n\n    pivot = pd.pivot_table(\n        df,\n        index=index_col,\n        values=value_col,\n        aggfunc=aggfunc,\n    )\n\n    return pivot.reset_index()", "code_hash": "f69c8670cc82936edd19eee771ee5ef9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "urSm", "name": "*build_pivot_table"}, {"code": "def _(df_users_2, mo):\n    import pandas as pd\n\n    # candidates for index (rows): typically categorical\n    index_cols = df_users_2.select_dtypes(include=[\"object\", \"category\", \"bool\"]).columns.tolist()\n    if not index_cols:\n        index_cols = df_users_2.columns.tolist()  # fallback\n\n    # candidates for values: numeric features\n    value_cols = df_users_2.select_dtypes(include=\"number\").columns.tolist()\n\n    aggfunc_options = [\"Mean\", \"Sum\", \"Count\", \"Std\", \"Min\", \"Max\"]\n\n    index_select = mo.ui.dropdown(\n        options=index_cols,\n        label=\"Index (rows)\",\n        value=index_cols[0],\n    )\n\n    value_select = mo.ui.dropdown(\n        options=value_cols,\n        label=\"Feature (values)\",\n        value=value_cols[0],\n    )\n\n    aggfunc_select = mo.ui.dropdown(\n        options=aggfunc_options,\n        label=\"Aggregation\",\n        value=\"Mean\",\n    )\n\n    # Show the controls\n    mo.hstack([index_select, value_select, aggfunc_select])\n\n    return index_select, value_select, aggfunc_select", "code_hash": "9d20e824eaaf97c044bb39164d094aec", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "def _(df_users_2, index_select, value_select, aggfunc_select, build_pivot_table, mo):\n    index_col = index_select.value\n    value_col = value_select.value\n    aggfunc_name = aggfunc_select.value\n\n    pivot = build_pivot_table(\n        df_users_2,\n        index_col=index_col,\n        value_col=value_col,\n        aggfunc_name=aggfunc_name,\n    )\n\n    mo.vstack(\n        [\n            mo.md(\n                f\"### Pivot table\\n\"\n                f\"- **Index:** `{index_col}`  \\n\"\n                f\"- **Feature:** `{value_col}`  \\n\"\n                f\"- **Aggfunc:** `{aggfunc_name}`\"\n            ),\n            mo.ui.table(pivot),\n        ]\n    )\n\n    return pivot", "code_hash": "c3025f700a7c6d8cdc2fd5b7eca22814", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mWxS", "name": "_"}, {"code": "multi_features = mo.ui.multiselect(\n    options=df_users_3.columns.tolist(),\n    label=\"Choose multiple columns\",\n    value=[],      \n    )\n\nmulti_index = mo.ui.multiselect(\n    options=df_users_3.select_dtypes(\"object\").columns,\n    label=\"Choose multiple columns\",\n    value=[],      \n    )\n\nmo.vstack([multi_index, multi_features, ])", "code_hash": "7bd488af06c4df1a348931871371358c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "CcZR", "name": "_"}, {"code": "pd.pivot_table(\n    df_users_3,\n    index=multi_index.value,\n    columns=multi_index.value,\n    values=None,\n    aggfunc=\"size\"\n)", "code_hash": "3dabdc998ec6c7d519bae890c4c12047", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YWSi", "name": "_"}, {"code": "df_users_3['first_city'] = df_users_3['first_city'].map(\n    df_city.set_index('city_id')['city_name']\n)", "code_hash": "a433cb59721e8dabb0c75677f0c8e2a7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zlud", "name": "_"}, {"code": "multi_index.value", "code_hash": "d9aeaa7402aeb9955fa214c096c2bc1e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "tZnO", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xvXZ", "name": "_"}], "metadata": {"marimo_version": "0.18.3"}, "version": "1"},
            "session": {"cells": [{"code_hash": "81a581141199195f22a89a651aff3b91", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"importing-the-required-libraries\"\u003EImporting The Required Libraries\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "913ee29ba96c561bdfa180c0be962b31", "console": [{"mimetype": "application/vnd.marimo+traceback", "name": "stderr", "text": "\u003Cspan class=\"codehilite\"\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Cspan class=\"gt\"\u003ETraceback (most recent call last):\u003C/span\u003E\n  File \u003Cspan class=\"nb\"\u003E\u0026quot;C:\\Users\\ASUS\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\marimo\\_runtime\\executor.py\u0026quot;\u003C/span\u003E, line \u003Cspan class=\"m\"\u003E138\u003C/span\u003E, in \u003Cspan class=\"n\"\u003Eexecute_cell\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"n\"\u003Eexec\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ecell\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ebody\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Eglbls\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n  File \u003Cspan class=\"nb\"\u003E\u0026quot;C:\\Users\\ASUS\\AppData\\Local\\Temp\\marimo_14656\\__marimo__cell_MJUe_.py\u0026quot;\u003C/span\u003E, line \u003Cspan class=\"m\"\u003E1\u003C/span\u003E, in \u003Cspan class=\"n\"\u003E\u0026lt;module\u0026gt;\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Epandas\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eas\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Epd\u003C/span\u003E\n\u003Cspan class=\"gr\"\u003EModuleNotFoundError\u003C/span\u003E: \u003Cspan class=\"n\"\u003ENo module named \u0026#39;pandas\u0026#39;\u003C/span\u003E\n\u003C/pre\u003E\u003C/div\u003E\n\u003C/span\u003E", "type": "stream"}], "id": "MJUe", "outputs": [{"ename": "exception", "evalue": "No module named 'pandas'", "traceback": [], "type": "error"}]}, {"code_hash": "e371f82b93e743f72b8bf2f0d595065c", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"our-functions\"\u003EOur Functions\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "75129dfd8233791d453283e995e83c3f", "console": [], "id": "bkHC", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "ab19a764c48cd0a2784d2dc9625f7d25", "console": [], "id": "lEQa", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "58a6c73208284c486034129a59dd341f", "console": [], "id": "PKri", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "ae9f7dac98fac69a9c1a6edcd5f789b8", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"getting-our-data\"\u003EGetting Our Data\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3fc1e655053bf17d34c8f0c099e98ada", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"visual-looking-to-our-datasets\"\u003EVisual Looking To Our Datasets\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "43a6bce4eb237e048cb1030ac2b9f9c6", "console": [], "id": "BYtC", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "c31453c41a95a2b0216887320d54e205", "console": [], "id": "RGSE", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "47229d0153b394f1092a475009d4a41d", "console": [], "id": "Kclp", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "c0b01694f1185bb29a942c0fc8e18216", "console": [], "id": "emfo", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "2d997aacd734523bf8fdd9c059ec5d82", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"data-preparation-cleaning-preprocessing\"\u003EData Preparation: Cleaning \u0026amp; Preprocessing\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c4c3fd82171c73470b01ceb0950f63a8", "console": [], "id": "nWHF", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "1741f0f6eac0d00faafc0fda28a0a63c", "console": [], "id": "iLit", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "080e13d3bf59e0c1509496b39807b283", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003EAs we see, the time columns are strings instead of datetime\u003C/span\u003E\n\u003C/blockquote\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6296bdb5e00c95e25d6def5837dca9d1", "console": [], "id": "ROlb", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "2b36d1fbd65d8d53e77bfc5a325ac07a", "console": [], "id": "qnkX", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "0d9ca13c9c877a426582e4af74dbfce5", "console": [], "id": "TqIu", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "ca8b97e8314930a4e448bd52cb2ebb14", "console": [], "id": "Vxnm", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "1d4806dd1ca99cd4b3182f7a649cb7d8", "console": [], "id": "DnEU", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "e05fba688f33cf0213cd439191da21ee", "console": [], "id": "ulZA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"ml-model-part\"\u003EML Model Part\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "316a2a5bcb80319b1a07c6b2fea91817", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"feature-engineering-part\"\u003EFeature Engineering Part\u003C/h3\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d8784e5e4d547b56d5bced1407e131c2", "console": [], "id": "Pvdt", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "c1e7287e188a76a5f9bf4bead73b6eca", "console": [], "id": "ZBYS", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "4d46dd235ffdd34ac6196e76d776f66f", "console": [], "id": "aLJB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"clustering-part\"\u003EClustering Part\u003C/h3\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "052e3eb9fa7fbea71be1f84fee72e3e5", "console": [], "id": "nHfw", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "e5f7ce3e60ebe03ecd6580e0be3777d1", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003ELet's get the best number of clusters for our data\u003C/span\u003E\n\u003C/blockquote\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7bc7ec2e10da402a5c7336752a3b5018", "console": [], "id": "AjVT", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "8942258020e41987cafba7febdd837a1", "console": [], "id": "pHFh", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "be0503e208c46b58ecca120b160ef826", "console": [], "id": "NCOB", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "b33fc50eaae9b2549e8975bfb4d3480e", "console": [], "id": "aqbW", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "36a9ce56e6e455a5fe31002a8af2e214", "console": [], "id": "TRpd", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003EThe analysis shows that the segments worth focusing on are the moderate-usage customers with an average lifetime near to 306 days, and the high-usage customers near to 282 days. The other clusters represent casual users whose churn is less critical.\u003C/span\u003E\n\u003C/blockquote\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "19d269fd4e14f1a84be04fe971f5e785", "console": [], "id": "TXez", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"the-visualization-part\"\u003EThe Visualization Part\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "dNNg", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "061f178164b1eb63754626691ccdf1e3", "console": [], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "704a940694d468938ce20770a588a7b7", "console": [], "id": "wlCL", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "83e264c234a0318cf79b5bda083326b5", "console": [], "id": "kqZH", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "2f6a2b3f287044a9c28208b320ab3e25", "console": [], "id": "wAgl", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "aefbd12c9ce0c25516322711efe8f740", "console": [], "id": "rEll", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "dad2a7c37b65a466fd57ec09520e9254", "console": [], "id": "dGlV", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "cc451f25abd6dd52f07a6000b8851f1e", "console": [], "id": "SdmI", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "1fadd0e86492e0afcc34bbc39f4e4792", "console": [], "id": "lgWD", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "7967f575a1ca9fc5b5d1c63fa1eca5fb", "console": [], "id": "yOPj", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "05e90bb1d003f155e29af82519de7e0d", "console": [], "id": "fwwy", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "5b7fc77280f110365887a4e3ecacb8a2", "console": [], "id": "LJZf", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "f69c8670cc82936edd19eee771ee5ef9", "console": [], "id": "urSm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9d20e824eaaf97c044bb39164d094aec", "console": [], "id": "jxvo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c3025f700a7c6d8cdc2fd5b7eca22814", "console": [], "id": "mWxS", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7bd488af06c4df1a348931871371358c", "console": [], "id": "CcZR", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "3dabdc998ec6c7d519bae890c4c12047", "console": [], "id": "YWSi", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "a433cb59721e8dabb0c75677f0c8e2a7", "console": [], "id": "zlud", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": "d9aeaa7402aeb9955fa214c096c2bc1e", "console": [], "id": "tZnO", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (ModuleNotFoundError): ", "traceback": [], "type": "error"}]}, {"code_hash": null, "console": [], "id": "xvXZ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.3"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.3%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Importing%20The%20Required%20Libraries%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20import%20os%20%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%0A%20%20%20%20from%20sklearn.preprocessing%20import%20StandardScaler%0A%20%20%20%20from%20sklearn.linear_model%20import%20LogisticRegression%0A%20%20%20%20from%20sklearn.ensemble%20import%20RandomForestClassifier%0A%20%20%20%20from%20sklearn.cluster%20import%20KMeans%0A%20%20%20%20from%20sklearn.metrics%20import%20accuracy_score%2C%20confusion_matrix%2C%20classification_report%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20KMeans%2C%0A%20%20%20%20%20%20%20%20StandardScaler%2C%0A%20%20%20%20%20%20%20%20accuracy_score%2C%0A%20%20%20%20%20%20%20%20classification_report%2C%0A%20%20%20%20%20%20%20%20confusion_matrix%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20plt%2C%0A%20%20%20%20%20%20%20%20sns%2C%0A%20%20%20%20%20%20%20%20train_test_split%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Our%20Functions%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20def%20CorrectDate(df)%3A%0A%20%20%20%20%20%20%20%20for%20col%20in%20df.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'date'%20in%20col%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20pd.to_datetime(df%5Bcol%5D)%0A%20%20%20%20return%20(CorrectDate%2C)%0A%0A%0A%40app.cell%0Adef%20_(StandardScaler%2C%20train_test_split)%3A%0A%20%20%20%20def%20Split_and_scale(X%2C%20y%2C%20test_size%3D0.2%2C%20scaled%3DTrue)%3A%0A%20%20%20%20%20%20%20%20_X_train%2C%20_X_test%2C%20_y_train%2C%20_y_test%20%3D%20train_test_split(X%2C%20y%2C%20test_size%3D0.2%2C%20random_state%3D42)%20%20%23%20Splitting%20the%20data%20into%20training%20and%20testing%20sets%0A%20%20%20%20%20%20%20%20if%20scaled%20%3D%3D%20True%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20scaler%20%3D%20StandardScaler()%0A%20%20%20%20%20%20%20%20%20%20%20%20_X_train_scaled%20%3D%20scaler.fit_transform(_X_train)%20%20%23%20Returning%20scaled%20or%20unscaled%20data%20based%20on%20the%20Scaled%20parameter%0A%20%20%20%20%20%20%20%20%20%20%20%20_X_test_scaled%20%3D%20scaler.transform(_X_test)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(_X_train_scaled%2C%20_X_test_scaled%2C%20_y_train%2C%20_y_test)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(_X_train%2C%20_X_test%2C%20_y_train%2C%20_y_test)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(accuracy_score%2C%20classification_report%2C%20confusion_matrix)%3A%0A%20%20%20%20def%20Evaluate_model(y_test%2C%20y_pred)%3A%0A%20%20%20%20%20%20%20%20print('Accuracy%3A'%2C%20accuracy_score(_y_test%2C%20_y_pred))%0A%20%20%20%20%20%20%20%20print(confusion_matrix(_y_test%2C%20_y_pred))%0A%20%20%20%20%20%20%20%20print(classification_report(_y_test%2C%20_y_pred))%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Getting%20Our%20Data%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Visual%20Looking%20To%20Our%20Datasets%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20df_calendar%20%3D%20pd.read_csv('..%2Fcalendar.csv')%0A%20%20%20%20df_calendar%0A%20%20%20%20return%20(df_calendar%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20df_city%20%3D%20pd.read_csv('..%2Fcity.csv')%0A%20%20%20%20df_city%0A%20%20%20%20return%20(df_city%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20df_passenger%3D%20pd.read_csv('passenger.csv')%0A%20%20%20%20df_passenger%0A%20%20%20%20return%20(df_passenger%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20df_trip%20%3D%20pd.read_csv('trip.csv')%0A%20%20%20%20df_trip%0A%20%20%20%20return%20(df_trip%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Data%20Preparation%3A%20Cleaning%20%26%20Preprocessing%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_calendar%2C%20df_city%2C%20df_passenger)%3A%0A%20%20%20%20%23%20Rename%20columns%20to%20add%20prefixes%0A%20%20%20%20df_city.columns%20%20%3D%20'city_'%20%2B%20df_city.columns%20%0A%20%20%20%20df_passenger.columns%20%20%3D%20'passenger_'%20%2B%20df_passenger.columns%0A%20%20%20%20df_calendar.columns%20%20%3D%20'calendar_'%20%2B%20df_calendar.columns%0A%0A%20%20%20%20%23%20This%20will%20rename%20a%20specific%20column%20back%20to%20its%20original%20name%0A%20%20%20%20df_calendar.rename(columns%3D%7B'calendar_calendar_date'%3A%20'calendar_date'%7D%2C%20inplace%3DTrue)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_city%2C%20df_passenger%2C%20df_trip)%3A%0A%20%20%20%20%23%20Adding%20the%20city%20names%20and%20first_call_time%20to%20our%20trips%20dataframe%0A%20%20%20%20%23%20by%20merging%20on%20df_trip%2C%20df_city%2C%20and%20df_passenger%0A%20%20%20%20df%20%3D%20df_trip.merge(df_city%2C%20on%3D'city_id'%2C%20how%3D'left')%0A%20%20%20%20df%20%3D%20df.merge(df_passenger%2C%20on%3D'passenger_id'%2C%20how%3D'left')%0A%0A%20%20%20%20%23%20Let's%20see%20the%20shape%20of%20the%20dataframe%20after%20merging%0A%20%20%20%20print(df.info()%2C%20'%5Cn-------------%5Cn')%0A%20%20%20%20df.head()%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%3E%20As%20we%20see%2C%20the%20time%20columns%20are%20strings%20instead%20of%20datetime%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20df_calendar%2C%20pd)%3A%0A%20%20%20%20%23%20Let's%20correct%20time%20and%20date%20columns%0A%20%20%20%20df%5B'call_time'%5D%20%3D%20pd.to_datetime(df%5B'call_time'%5D%2C%20format%3D%22%25m%2F%25d%2F%25Y%20%25I%3A%25M%3A%25S%20%25p%22)%0A%20%20%20%20df%5B'finish_time'%5D%20%3D%20pd.to_datetime(df%5B'finish_time'%5D%2C%20format%3D%22%25m%2F%25d%2F%25Y%20%25I%3A%25M%3A%25S%20%25p%22)%0A%20%20%20%20df%5B'passenger_first_call_time'%5D%20%3D%20pd.to_datetime(df%5B'passenger_first_call_time'%5D%2C%20format%3D%22%25m%2F%25d%2F%25Y%20%25I%3A%25M%3A%25S%20%25p%22)%0A%20%20%20%20df%5B'Trip_duration'%5D%20%3D%20(df%5B'finish_time'%5D%20-%20df%5B'call_time'%5D).dt.total_seconds()%20%2F%2060%0A%20%20%20%20df_calendar%5B'calendar_date'%5D%20%3D%20pd.to_datetime(df_calendar%5B'calendar_date'%5D%2C%20format%3D%22%25m%2F%25d%2F%25Y%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(CorrectDate%2C%20df)%3A%0A%20%20%20%20%23%20Extract%20date%20from%20datetime%20columns%0A%20%20%20%20df%5B'passenger_first_call_date'%5D%20%3D%20df%5B'passenger_first_call_time'%5D.dt.date%0A%20%20%20%20df%5B'call_date'%5D%20%3D%20df%5B'call_time'%5D.dt.date%0A%0A%20%20%20%20%23%20The%20new%20columns%20will%20be%20of%20object%20type%2C%20so%20we%20convert%20them%20to%20datetime%0A%20%20%20%20CorrectDate(df)%0A%0A%20%20%20%20%23%20Let's%20see%20the%20final%20structure%20of%20our%20dataframe%0A%20%20%20%20print(df.columns)%0A%20%20%20%20print('%5Cn-------------------%5Cn')%0A%20%20%20%20print(df.info())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(CorrectDate%2C%20df%2C%20pd)%3A%0A%20%20%20%20%23%20The%20current%20dataframe%20'df'%20contains%20trip-level%20data.%0A%20%20%20%20%23%20We%20will%20now%20aggregate%20this%20data%20to%20create%20a%20user-level%20dataframe%20'df_users'.%0A%20%20%20%20df_users%20%3D%20pd.pivot_table(%0A%20%20%20%20%20%20%20%20df%2C%0A%20%20%20%20%20%20%20%20index%3D%5B'passenger_id'%5D%2C%0A%20%20%20%20%20%20%20%20aggfunc%3D%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20'id'%3A%20'nunique'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'city_id'%3A%20'first'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'city_name'%3A%20'nunique'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'driver_id'%3A%20'nunique'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20'surge_rate'%3A%20'mean'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20'trip_distance'%3A%20%5B'sum'%2C%20'mean'%5D%2C%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20'trip_fare'%3A%20%5B'sum'%2C%20'mean'%5D%2C%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20'passenger_first_call_date'%3A%20'first'%2C%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20'call_date'%3A%20'last'%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20print('Old%20Columns'%2C%20df_users.columns)%0A%0A%20%20%20%20%23%20Flattening%20and%20renaming%20multiIndex%20columns%0A%20%20%20%20df_users.columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20'last_trip_date'%2C%0A%20%20%20%20%20%20%20%20'first_city'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'distinct_cities'%2C%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'distinct_drivers'%2C%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'total_trips'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'first_trip_date'%2C%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'avg_surge'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'avg_trip_distance'%2C%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'total_trip_distance'%2C%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'avg_trip_fare'%2C%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20'total_trip_fare'%20%20%20%20%20%20%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Changing%20date%20columns%20to%20datetime%20format%0A%20%20%20%20CorrectDate(df_users)%0A%0A%20%20%20%20%23%20Let's%20reset%20the%20index%20to%20have%20passenger_id%20as%20a%20column%0A%20%20%20%20df_users.reset_index(inplace%3DTrue)%0A%0A%20%20%20%20%23%20Final%20structure%20of%20user-level%20dataframe%0A%20%20%20%20df_users.info()%0A%20%20%20%20return%20(df_users%2C)%0A%0A%0A%40app.cell%0Adef%20_(churn_threshold_slider%2C%20df%2C%20df_users)%3A%0A%20%20%20%20%23%20According%20to%20the%20problem%20definition%2C%20a%20customer%20is%20considered%20churned%20if%20they%20haven%E2%80%99t%20%0A%20%20%20%20%23%20used%20the%20application%20for%20more%20than%2028%20days.%0A%20%20%20%20%23%20Let's%20get%20the%20churn%20threshold%20date%0A%20%20%20%20all_dates%20%3D%20df%5B%5B'call_date'%5D%5D.sort_values(by%3D'call_date')%5B'call_date'%5D.unique()%0A%20%20%20%20max_date%20%3D%20all_dates%5B-1%5D%0A%20%20%20%20steps_back%20%3D%20churn_threshold_slider.value%20%2B%201%0A%20%20%20%20churn_cutoff%20%3D%20all_dates%5B-steps_back%5D%0A%20%20%20%20mau_index%20%3D%20df_users%5Bdf_users%5B'last_trip_date'%5D%20%3C%20churn_cutoff%5D.index%0A%20%20%20%20df_users%5B'Churn'%5D%20%3D%200%0A%20%20%20%20df_users.loc%5Bmau_index%2C%20'Churn'%5D%20%3D%201%0A%20%20%20%20churn_rate%20%3D%20df_users%5B'Churn'%5D.mean()%0A%20%20%20%20return%20(churn_cutoff%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_calendar%2C%20df_users)%3A%0A%20%20%20%20%23%20The%20only%20columns%20I%20want%20from%20calendar%20are%20calendar_date%20and%20calendar_holiday%0A%20%20%20%20df_calendar_1%20%3D%20df_calendar%5B%5B'calendar_date'%2C%20'calendar_holiday'%5D%5D%0A%20%20%20%20df_users_1%20%3D%20df_users.merge(df_calendar_1%2C%20left_on%3Ddf_users%5B'first_trip_date'%5D%2C%20right_on%3Ddf_calendar_1%5B'calendar_date'%5D%2C%20how%3D'left')%0A%20%20%20%20%23%20Merge%20to%20df_users%20and%20df_calendar%20to%20get%20which%20customers%20joined%20to%20us%20on%20a%20holiday%0A%20%20%20%20df_users_1%5B'Joined%20On%20Holiday'%5D%20%3D%20df_users_1%5B'calendar_holiday'%5D%0A%20%20%20%20df_users_1%5B'Churn'%5D%20%3D%20df_users%5B'Churn'%5D%20%0A%20%20%20%20df_users_1.drop(columns%3D%5B'calendar_date'%2C%20'calendar_holiday'%2C%20'key_0'%5D%2C%20inplace%3DTrue)%0A%20%20%20%20%23%20Droping%20unnecessary%20columns%20%0A%20%20%20%20df_users_1.dropna(inplace%3DTrue)%0A%20%20%20%20%23%20We%20have%20some%20NaN%20values%20in%20avg_surge%20and%20trip_distance%20columns%0A%20%20%20%20%23%20They%20are%20a%20few%2C%20so%20let's%20drop%20them%0A%20%20%20%20%23%20Final%20structure%20of%20user-level%20dataframe%0A%20%20%20%20df_users_1.info()%0A%20%20%20%20return%20(df_users_1%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20ML%20Model%20Part%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Feature%20Engineering%20Part%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(churn_cutoff%2C%20df_users_1%2C%20np)%3A%0A%20%20%20%20%23%20Creating%20our%20new%20features%0A%20%20%20%20df_users_1%5B'Customer_Lifetime_Days'%5D%20%3D%20(churn_cutoff%20-%20df_users_1%5B'first_trip_date'%5D).dt.days%0A%20%20%20%20df_users_1%5B%22trips_per_week%22%5D%20%3D%20df_users_1%5B%22total_trips%22%5D%20%2F%20((df_users_1%5B%22Customer_Lifetime_Days%22%5D%20%2F%207)%20%2B%201)%0A%20%20%20%20df_users_1%5B'days_since_last_trip'%5D%20%3D%20df_users_1%5B'Customer_Lifetime_Days'%5D%20-%20df_users_1%5B'last_trip_date'%5D.dt.dayofyear%0A%20%20%20%20df_users_1%5B'trips_per_day'%5D%20%3D%20df_users_1%5B'total_trips'%5D%20%2F%20(df_users_1%5B'Customer_Lifetime_Days'%5D%20%2B%201)%0A%20%20%20%20df_users_1%5B'fare_per_km'%5D%20%3D%20df_users_1%5B'total_trip_fare'%5D%20%2F%20(df_users_1%5B'total_trip_distance'%5D%20%2B%201)%0A%20%20%20%20df_users_1%5B'fare_per_trip'%5D%20%3D%20df_users_1%5B'total_trip_fare'%5D%20%2F%20(df_users_1%5B'total_trips'%5D%20%2B%201)%0A%20%20%20%20df_users_1%5B'surge_volatility'%5D%20%3D%20df_users_1%5B'avg_surge'%5D%20*%20df_users_1%5B'distinct_cities'%5D%0A%20%20%20%20df_users_1%5B'long_trip_ratio'%5D%20%3D%20df_users_1%5B'total_trip_distance'%5D%20%2F%20(df_users_1%5B'avg_trip_distance'%5D%20%2B%201)%0A%20%20%20%20df_users_1%5B'lifetime_trip_rate'%5D%20%3D%20df_users_1%5B'total_trips'%5D%20%2F%20(df_users_1%5B'Customer_Lifetime_Days'%5D%20%2B%201)%0A%20%20%20%20df_users_2%20%3D%20df_users_1.replace(%5Bnp.inf%2C%20-np.inf%5D%2C%20np.nan)%0A%20%20%20%20%23%20Corecting%20inf%20due%20to%20dividion%20by%20zero%0A%20%20%20%20%23%20We%20have%20some%20NaN%20values%20after%20creating%20new%20features%0A%20%20%20%20df_users_2.dropna(inplace%3DTrue)%0A%20%20%20%20df_users_1%0A%20%20%20%20return%20(df_users_2%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_users_2%2C%20plt%2C%20sns)%3A%0A%20%20%20%20new_features%20%3D%20%5B'days_since_last_trip'%2C%20'trips_per_day'%2C%20'trips_per_week'%2C%20'fare_per_km'%2C%20'fare_per_trip'%2C%20'surge_volatility'%2C%20'long_trip_ratio'%2C%20'lifetime_trip_rate'%2C%20'Churn'%5D%0A%20%20%20%20plt.figure(figsize%3D(12%2C%2010))%0A%20%20%20%20sns.heatmap(df_users_2%5Bnew_features%5D.corr()%2C%20annot%3DFalse)%0A%20%20%20%20plt.title('Correlation%20Heatmap')%0A%20%20%20%20plt.show()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Clustering%20Part%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(StandardScaler%2C%20df_users_2)%3A%0A%20%20%20%20%23%20Our%20Chosed%20features%0A%20%20%20%20Cluster_f%20%3D%20%5B'Customer_Lifetime_Days'%2C%20'trips_per_week'%2C%20'lifetime_trip_rate'%2C%20'fare_per_trip'%2C%20'total_trip_fare'%2C%20'long_trip_ratio'%2C%20'distinct_cities'%5D%0A%20%20%20%20cluster_features%20%3D%20df_users_2%5BCluster_f%5D.copy()%0A%20%20%20%20scaler%20%3D%20StandardScaler()%0A%20%20%20%20%23%20Getting%20a%20copy%20of%20our%20data%20with%20the%20most%20important%20features%0A%20%20%20%20%23%20Scale%20features%0A%20%20%20%20X_scaled%20%3D%20scaler.fit_transform(cluster_features)%0A%20%20%20%20return%20X_scaled%2C%20cluster_features%2C%20scaler%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%3E%20Let's%20get%20the%20best%20number%20of%20clusters%20for%20our%20data%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(KMeans%2C%20X_scaled%2C%20plt)%3A%0A%20%20%20%20inertias%20%3D%20%5B%5D%0A%20%20%20%20K%20%3D%20range(2%2C%208)%0A%0A%20%20%20%20for%20k%20in%20K%3A%0A%20%20%20%20%20%20%20%20km%20%3D%20KMeans(n_clusters%3Dk%2C%20random_state%3D42%2C%20n_init%3D10)%0A%20%20%20%20%20%20%20%20km.fit(X_scaled)%0A%20%20%20%20%20%20%20%20inertias.append(km.inertia_)%0A%0A%20%20%20%20plt.figure(figsize%3D(7%2C%204))%0A%20%20%20%20plt.plot(K%2C%20inertias%2C%20marker%3D'o')%0A%20%20%20%20plt.xlabel(%22Number%20of%20clusters%20(k)%22)%0A%20%20%20%20plt.ylabel(%22Inertia%22)%0A%20%20%20%20plt.title(%22Elbow%20Method%20for%20Optimal%20k%22)%0A%20%20%20%20plt.grid(True)%0A%20%20%20%20plt.show()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(KMeans%2C%20X_scaled%2C%20df_users_2%2C%20n_clusters_slider)%3A%0A%20%20%20%20best_k%20%3D%20n_clusters_slider.value%0A%20%20%20%20kmeans_final%20%3D%20KMeans(n_clusters%3Dbest_k%2C%20random_state%3D42%2C%20n_init%3D10)%0A%20%20%20%20_cluster_labels%20%3D%20kmeans_final.fit_predict(X_scaled)%0A%20%20%20%20df_users_2%5B'cluster_behavior'%5D%20%3D%20_cluster_labels%0A%20%20%20%20return%20(kmeans_final%2C)%0A%0A%0A%40app.cell%0Adef%20_(cluster_features%2C%20kmeans_final%2C%20pd%2C%20scaler)%3A%0A%20%20%20%20%23%20Let's%20get%20the%20centers%20and%20figure%20out%20the%20charaterics%20of%20our%20clusters%0A%20%20%20%20centers%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20scaler.inverse_transform(kmeans_final.cluster_centers_)%2C%0A%20%20%20%20%20%20%20%20columns%3Dcluster_features.columns%0A%20%20%20%20)%0A%0A%20%20%20%20centers%0A%20%20%20%20return%20(centers%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_users_2)%3A%0A%20%20%20%20%23%20Renaming%20our%20clusters%0A%20%20%20%20df_users_2%5B'cluster_behavior'%5D.replace(%7B0%3A%20'Casual%20Customer'%2C%201%3A%20'High-usage%20customers'%2C%202%3A%20'Moderate-usage%20customers'%7D%2C%20inplace%3DTrue)%0A%20%20%20%20%23%20Showing%20different%20clusters%20of%20our%20current%20users%0A%20%20%20%20df_users_2%5Bdf_users_2%5B'Churn'%5D%20%3D%3D%200%5D%5B'cluster_behavior'%5D.value_counts()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%3E%20The%20analysis%20shows%20that%20the%20segments%20worth%20focusing%20on%20are%20the%20moderate-usage%20customers%20with%20an%20average%20lifetime%20near%20to%20306%20days%2C%20and%20the%20high-usage%20customers%20near%20to%20282%20days.%20The%20other%20clusters%20represent%20casual%20users%20whose%20churn%20is%20less%20critical.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20The%20Visualization%20Part%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20churn_threshold_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D28%2C%20stop%3D180%2C%20value%3D28%2C%0A%20%20%20%20%20%20%20%20label%3D%22Churn%20inactivity%20threshold%20(days)%22%0A%20%20%20%20)%0A%0A%20%20%20%20n_clusters_slider%20%3D%20mo.ui.slider(start%3D3%2C%20stop%3D12%2C%20step%3D1%2C%20label%3D%22Number%20of%20clusters%22)%0A%0A%0A%20%20%20%20trips_week_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D1%2C%20stop%3D10%2C%20value%3D1%2C%0A%20%20%20%20%20%20%20%20label%3D%22Trips%20per%20week%22%0A%20%20%20%20)%0A%20%20%20%20return%20churn_threshold_slider%2C%20n_clusters_slider%2C%20trips_week_slider%0A%0A%0A%40app.cell%0Adef%20_(df_users_2%2C%20mo)%3A%0A%20%20%20%20date_from%20%3D%20mo.ui.date(%0A%20%20%20%20%20%20%20%20label%3D%22From%22%2C%0A%20%20%20%20%20%20%20%20value%3Dstr(df_users_2%5B'last_trip_date'%5D.min().date())%0A%20%20%20%20)%0A%0A%20%20%20%20apply_button%20%3D%20mo.ui.button(%22Apply%20Date%20Range%22)%0A%0A%20%20%20%20date_to%20%3D%20mo.ui.date(%0A%20%20%20%20%20%20%20%20label%3D%22To%22%2C%0A%20%20%20%20%20%20%20%20value%3Dstr(df_users_2%5B'last_trip_date'%5D.max().date())%0A%20%20%20%20)%0A%0A%20%20%20%20apply_button%20%3D%20mo.ui.button(%22Apply%20Date%20Range%22)%0A%20%20%20%20return%20apply_button%2C%20date_from%2C%20date_to%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20apply_button%2C%0A%20%20%20%20churn_threshold_slider%2C%0A%20%20%20%20date_from%2C%0A%20%20%20%20date_to%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20n_clusters_slider%2C%0A%20%20%20%20trips_week_slider%2C%0A)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20churn_threshold_slider%2C%0A%20%20%20%20%20%20%20%20n_clusters_slider%2C%0A%20%20%20%20%20%20%20%20trips_week_slider%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5Bdate_from%2C%20date_to%2C%20apply_button%5D)%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(date_from%2C%20date_to%2C%20df_users_2)%3A%0A%20%20%20%20df_users_3%20%3D%20df_users_2%5Bdf_users_2%5B'last_trip_date'%5D.between(str(date_from.value)%2Cstr(date_to.value))%5D%0A%20%20%20%20return%20(df_users_3%2C)%0A%0A%0A%40app.cell%0Adef%20_(churn_cutoff%2C%20churn_threshold_slider%2C%20df_users_3%2C%20mo)%3A%0A%20%20%20%20churned%20%3D%20df_users_3%5B%22Churn%22%5D.sum()%0A%20%20%20%20churn_rate_%20%3D%20df_users_3%5B%22Churn%22%5D.mean()%0A%0A%0A%20%20%20%20last_date_%20%3D%20df_users_3.sort_values('last_trip_date'%2C%20ascending%20%3D%20False)%5B'last_trip_date'%5D.unique()%5B%3Achurn_threshold_slider.value%5D%5B-1%5D%0A%20%20%20%20active_users%20%3D%20df_users_3%5Bdf_users_3%5B'last_trip_date'%5D%3E%20last_date_%5D%5B%22passenger_id%22%5D.nunique()%0A%0A%0A%20%20%20%20card1%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Churn%20cutoff%20date%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20**%7Bchurn_cutoff%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20card2%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Churned%20users%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20**%7Bchurned%3A%2C%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20card3%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Churn%20rate%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20**%7Bchurn_rate_%3A.2%25%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20card4%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Active%20Users%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20**%7Bactive_users%3A%2C%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%20Display%20them%20beside%20each%20other%20(like%20Power%20BI)%0A%20%20%20%20mo.hstack(%5Bcard1%2C%20card2%2C%20card3%2C%20card4%5D%2C%20widths%3D%22equal%22%2C%20gap%3D2)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(centers%2C%20np%2C%20plt)%3A%0A%20%20%20%20%23%20Getting%20feature%20columns%20from%20the%20cluster%20centers.%0A%20%20%20%20_features%20%3D%20list(centers.columns)%0A%20%20%20%20data%20%3D%20centers.values%0A%20%20%20%20%23%20Getting%20the%20centers%20values%0A%20%20%20%20data_min%20%3D%20data.min(axis%3D0)%0A%20%20%20%20data_max%20%3D%20data.max(axis%3D0)%0A%20%20%20%20%23%20Normalize%20Data%0A%20%20%20%20%23%20We%20scale%20all%20feature%20values%20to%20the%20range%200.1%E2%80%931.0%20so%20the%20radar%0A%20%20%20%20norm_data%20%3D%20(data%20-%20data_min)%20%2F%20(data_max%20-%20data_min%20%2B%201e-09)%0A%20%20%20%20norm_data%20%3D%200.1%20%2B%200.9%20*%20norm_data%0A%20%20%20%20plot_data%20%3D%20np.concatenate(%5Bnorm_data%2C%20norm_data%5B%3A%2C%20%5B0%5D%5D%5D%2C%20axis%3D1)%0A%20%20%20%20num_vars%20%3D%20data.shape%5B1%5D%0A%20%20%20%20angles%20%3D%20np.linspace(0%2C%202%20*%20np.pi%2C%20num_vars%2C%20endpoint%3DFalse)%0A%20%20%20%20%23%20Prepare%20Data%20for%20Radar%20Chart%0A%20%20%20%20angles%20%3D%20np.concatenate(%5Bangles%2C%20%5Bangles%5B0%5D%5D%5D)%0A%20%20%20%20_cluster_labels%20%3D%20%5Bf%22Cluster%20%7Bi%7D%22%20for%20i%20in%20range(centers.shape%5B0%5D)%5D%0A%20%20%20%20%23%20Create%20Angles%20for%20Each%20Feature%0A%20%20%20%20%23%20%20Angles%20are%20evenly%20spaced%20around%20the%20circle.%0A%20%20%20%20plt.figure(figsize%3D(8%2C%208))%0A%20%20%20%20ax%20%3D%20plt.subplot(111%2C%20polar%3DTrue)%0A%20%20%20%20for%20i%2C%20label%20in%20enumerate(_cluster_labels)%3A%20%20%23%20close%20the%20loop%0A%20%20%20%20%20%20%20%20ax.plot(angles%2C%20plot_data%5Bi%5D%2C%20linewidth%3D2%2C%20marker%3D'o'%2C%20label%3Dlabel)%0A%20%20%20%20%23%20Plot%20Radar%20Chart%0A%20%20%20%20%20%20%20%20ax.fill(angles%2C%20plot_data%5Bi%5D%2C%20alpha%3D0.15)%0A%20%20%20%20ax.set_xticks(angles%5B%3A-1%5D)%0A%20%20%20%20ax.set_xticklabels(_features)%0A%20%20%20%20ax.set_ylim(0%2C%201)%0A%20%20%20%20plt.title('Customer%20Loyalty%20Cluster%20Profile%20(Radar%20Chart)')%0A%20%20%20%20plt.legend(loc%3D'upper%20right'%2C%20bbox_to_anchor%3D(1.3%2C%201.1))%0A%20%20%20%20plt.tight_layout()%0A%20%20%20%20%23%20Format%20Axes%20and%20Labels%0A%20%20%20%20plt.show()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_3%2C%20plt)%3A%0A%20%20%20%20def%20plot_feature_bar_matplotlib(df%20%3D%20df_users_3%2C%20feature%20%3D%20'cluster_behavior'%20)%3A%0A%20%20%20%20%20%20%20%20df_grouped%20%3D%20df.groupby(%22cluster_behavior%22)%5Bfeature%5D.sum()%0A%20%20%20%20%20%20%20%20fig%2C%20ax%20%3D%20plt.subplots(figsize%3D(6%2C%204))%0A%20%20%20%20%20%20%20%20ax.bar(df_grouped.index%2C%20df_grouped%5Bfeature%5D)%0A%20%20%20%20%20%20%20%20ax.set_title(f%22Bar%20Chart%20for%20%7Bfeature%7D%22)%0A%20%20%20%20%20%20%20%20ax.set_xlabel(%22Index%22)%0A%20%20%20%20%20%20%20%20ax.set_ylabel(feature)%0A%20%20%20%20%20%20%20%20plt.tight_layout()%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_2%2C%20mo)%3A%0A%20%20%20%20cols%20%3D%20df_users_2.columns.tolist()%0A%0A%20%20%20%20feature_select1%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3Dcols%2C%0A%20%20%20%20%20%20%20%20label%3D%22Choose%20a%20feature%20for%20the%20barplot%22%2C%0A%20%20%20%20%20%20%20%20value%3Dcols%5B0%5D%0A%20%20%20%20)%0A%0A%0A%20%20%20%20feature_select2%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3Dcols%2C%0A%20%20%20%20%20%20%20%20label%3D%22Choose%20x%20feature%20to%20the%20barplot%22%2C%0A%20%20%20%20%20%20%20%20value%3Dcols%5B0%5D%0A%20%20%20%20)%0A%20%20%20%20mo.hstack(%5Bfeature_select1%2C%20feature_select2%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_3)%3A%0A%20%20%20%20def%20countplot_seaborn(df%2C%20feature)%3A%0A%20%20%20%20%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20%20%20%20%20import%20seaborn%20as%20sns%0A%0A%20%20%20%20%20%20%20%20plt.figure(figsize%3D(6%2C%204))%0A%0A%20%20%20%20%20%20%20%20%23%20Orange%20countplot%0A%20%20%20%20%20%20%20%20sns.countplot(%0A%20%20%20%20%20%20%20%20%20%20%20%20data%3Ddf%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dfeature%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3D%22%23FF8C00%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20plt.title(f%22Countplot%20of%20%7Bfeature%7D%22)%0A%20%20%20%20%20%20%20%20plt.xlabel(feature)%0A%20%20%20%20%20%20%20%20plt.ylabel(%22Number%20Of%20Users%22)%0A%20%20%20%20%20%20%20%20plt.xticks(rotation%3D45)%0A%20%20%20%20%20%20%20%20plt.tight_layout()%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20plt.gcf()%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%0A%0A%20%20%20%20countplot_seaborn(df_users_3%2C%20%22cluster_behavior%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_3)%3A%0A%20%20%20%20df_users_3.select_dtypes(%22object%22).columns%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_3)%3A%0A%20%20%20%20df_users_3%0A%20%20%20%20return%0A%0A%0A%40app.function%0Adef%20build_pivot_table(df%2C%20index_col%2C%20value_col%2C%20aggfunc_name)%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%0A%20%20%20%20%23%20Map%20readable%20names%20to%20real%20pandas%20aggfuncs%0A%20%20%20%20agg_map%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22Mean%22%3A%20%22mean%22%2C%0A%20%20%20%20%20%20%20%20%22Sum%22%3A%20%22sum%22%2C%0A%20%20%20%20%20%20%20%20%22Count%22%3A%20%22count%22%2C%0A%20%20%20%20%20%20%20%20%22Std%22%3A%20%22std%22%2C%0A%20%20%20%20%20%20%20%20%22Min%22%3A%20%22min%22%2C%0A%20%20%20%20%20%20%20%20%22Max%22%3A%20%22max%22%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20aggfunc%20%3D%20agg_map%5Baggfunc_name%5D%0A%0A%20%20%20%20pivot%20%3D%20pd.pivot_table(%0A%20%20%20%20%20%20%20%20df%2C%0A%20%20%20%20%20%20%20%20index%3Dindex_col%2C%0A%20%20%20%20%20%20%20%20values%3Dvalue_col%2C%0A%20%20%20%20%20%20%20%20aggfunc%3Daggfunc%2C%0A%20%20%20%20)%0A%0A%20%20%20%20return%20pivot.reset_index()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20def%20_(df_users_2%2C%20mo)%3A%0A%20%20%20%20%20%20%20%20import%20pandas%20as%20pd%0A%0A%20%20%20%20%20%20%20%20%23%20candidates%20for%20index%20(rows)%3A%20typically%20categorical%0A%20%20%20%20%20%20%20%20index_cols%20%3D%20df_users_2.select_dtypes(include%3D%5B%22object%22%2C%20%22category%22%2C%20%22bool%22%5D).columns.tolist()%0A%20%20%20%20%20%20%20%20if%20not%20index_cols%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20index_cols%20%3D%20df_users_2.columns.tolist()%20%20%23%20fallback%0A%0A%20%20%20%20%20%20%20%20%23%20candidates%20for%20values%3A%20numeric%20features%0A%20%20%20%20%20%20%20%20value_cols%20%3D%20df_users_2.select_dtypes(include%3D%22number%22).columns.tolist()%0A%0A%20%20%20%20%20%20%20%20aggfunc_options%20%3D%20%5B%22Mean%22%2C%20%22Sum%22%2C%20%22Count%22%2C%20%22Std%22%2C%20%22Min%22%2C%20%22Max%22%5D%0A%0A%20%20%20%20%20%20%20%20index_select%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dindex_cols%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Index%20(rows)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Dindex_cols%5B0%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20value_select%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dvalue_cols%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Feature%20(values)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Dvalue_cols%5B0%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20aggfunc_select%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Daggfunc_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Aggregation%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22Mean%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Show%20the%20controls%0A%20%20%20%20%20%20%20%20mo.hstack(%5Bindex_select%2C%20value_select%2C%20aggfunc_select%5D)%0A%0A%20%20%20%20%20%20%20%20return%20index_select%2C%20value_select%2C%20aggfunc_select%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20def%20_(df_users_2%2C%20index_select%2C%20value_select%2C%20aggfunc_select%2C%20build_pivot_table%2C%20mo)%3A%0A%20%20%20%20%20%20%20%20index_col%20%3D%20index_select.value%0A%20%20%20%20%20%20%20%20value_col%20%3D%20value_select.value%0A%20%20%20%20%20%20%20%20aggfunc_name%20%3D%20aggfunc_select.value%0A%0A%20%20%20%20%20%20%20%20pivot%20%3D%20build_pivot_table(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_users_2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20index_col%3Dindex_col%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value_col%3Dvalue_col%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aggfunc_name%3Daggfunc_name%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%23%23%23%20Pivot%20table%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22-%20**Index%3A**%20%60%7Bindex_col%7D%60%20%20%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22-%20**Feature%3A**%20%60%7Bvalue_col%7D%60%20%20%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22-%20**Aggfunc%3A**%20%60%7Baggfunc_name%7D%60%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(pivot)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20pivot%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_users_3%2C%20mo)%3A%0A%20%20%20%20multi_features%20%3D%20mo.ui.multiselect(%0A%20%20%20%20%20%20%20%20options%3Ddf_users_3.columns.tolist()%2C%0A%20%20%20%20%20%20%20%20label%3D%22Choose%20multiple%20columns%22%2C%0A%20%20%20%20%20%20%20%20value%3D%5B%5D%2C%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20multi_index%20%3D%20mo.ui.multiselect(%0A%20%20%20%20%20%20%20%20options%3Ddf_users_3.select_dtypes(%22object%22).columns%2C%0A%20%20%20%20%20%20%20%20label%3D%22Choose%20multiple%20columns%22%2C%0A%20%20%20%20%20%20%20%20value%3D%5B%5D%2C%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%5Bmulti_index%2C%20multi_features%2C%20%5D)%0A%20%20%20%20return%20(multi_index%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_users_3%2C%20multi_index%2C%20pd)%3A%0A%20%20%20%20pd.pivot_table(%0A%20%20%20%20%20%20%20%20df_users_3%2C%0A%20%20%20%20%20%20%20%20index%3Dmulti_index.value%2C%0A%20%20%20%20%20%20%20%20columns%3Dmulti_index.value%2C%0A%20%20%20%20%20%20%20%20values%3DNone%2C%0A%20%20%20%20%20%20%20%20aggfunc%3D%22size%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_city%2C%20df_users_3)%3A%0A%20%20%20%20df_users_3%5B'first_city'%5D%20%3D%20df_users_3%5B'first_city'%5D.map(%0A%20%20%20%20%20%20%20%20df_city.set_index('city_id')%5B'city_name'%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(multi_index)%3A%0A%20%20%20%20multi_index.value%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">c958adc0fc674144ee4b1822444d09de</marimo-code-hash>
</body>
</html>
